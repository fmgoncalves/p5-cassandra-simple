<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>p5-cassandra-simple by fmgoncalves</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>p5-cassandra-simple</h1>
        <p>Cassandra::Simple Perl Module - Easy to use, Perl oriented client interface to Apache Cassandra.</p>
        <p class="view"><a href="https://github.com/fmgoncalves/p5-cassandra-simple">View the Project on GitHub <small>fmgoncalves/p5-cassandra-simple</small></a></p>
        <ul>
          <li><a href="https://github.com/fmgoncalves/p5-cassandra-simple/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/fmgoncalves/p5-cassandra-simple/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/fmgoncalves/p5-cassandra-simple">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p></p>

 



<a name="___top"></a>

 
<ul>
<li class="indexItem indexItem1">
<a href="#NAME">NAME</a>
  </li>
<li class="indexItem indexItem1">
<a href="#VERSION">VERSION</a>
  </li>
<li class="indexItem indexItem1">
<a href="#DESCRIPTION">DESCRIPTION</a>
  </li>
<li class="indexItem indexItem1">
<a href="#SYNOPSYS">SYNOPSYS</a>
  <ul>
<li class="indexItem indexItem2">
<a href="#get">get</a>
    </li>
<li class="indexItem indexItem2">
<a href="#multiget">multiget</a>
    </li>
<li class="indexItem indexItem2">
<a href="#get_count">get_count</a>
    </li>
<li class="indexItem indexItem2">
<a href="#multiget_count">multiget_count</a>
    </li>
<li class="indexItem indexItem2">
<a href="#get_range">get_range</a>
    </li>
<li class="indexItem indexItem2">
<a href="#get_indexed_slices">get_indexed_slices</a>
    </li>
<li class="indexItem indexItem2">
<a href="#insert">insert</a>
    </li>
<li class="indexItem indexItem2">
<a href="#insert_super">insert_super</a>
    </li>
<li class="indexItem indexItem2">
<a href="#batch_insert">batch_insert</a>
    </li>
<li class="indexItem indexItem2">
<a href="#add">add</a>
    </li>
<li class="indexItem indexItem2">
<a href="#batch_add">batch_add</a>
    </li>
<li class="indexItem indexItem2">
<a href="#remove_counter">remove_counter</a>
    </li>
<li class="indexItem indexItem2">
<a href="#remove">remove</a>
    </li>
<li class="indexItem indexItem2">
<a href="#list_keyspace_cfs">list_keyspace_cfs</a>
    </li>
<li class="indexItem indexItem2">
<a href="#create_column_family">create_column_family</a>
    </li>
<li class="indexItem indexItem2">
<a href="#create_keyspace">create_keyspace</a>
    </li>
<li class="indexItem indexItem2">
<a href="#list_keyspaces">list_keyspaces</a>
    </li>
<li class="indexItem indexItem2">
<a href="#drop_keyspace">drop_keyspace</a>
    </li>
<li class="indexItem indexItem2">
<a href="#create_index">create_index</a>
    </li>
<li class="indexItem indexItem2">
<a href="#ring">ring</a>
  </li>
</ul>
</li>
<li class="indexItem indexItem1">
<a href="#BUGS">BUGS</a>
  </li>
<li class="indexItem indexItem1">
<a href="#TODO">TODO</a>
  </li>
<li class="indexItem indexItem1">
<a href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a>
  </li>
<li class="indexItem indexItem1">
<a href="#AUTHOR">AUTHOR</a>
  </li>
<li class="indexItem indexItem1">
<a href="#COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</a>
</li>
</ul> 

<h1><a href="#___top" title="click to go to top of document" name="NAME">NAME</a></h1>

<p>Cassandra::Simple</p>

<h1><a href="#___top" title="click to go to top of document" name="VERSION">VERSION</a></h1>

<p>version 0.1</p>

<h1><a href="#___top" title="click to go to top of document" name="DESCRIPTION">DESCRIPTION</a></h1>

<p>Easy to use,
Perl oriented client interface to Apache Cassandra.</p>

<p>This module attempts to abstract the underlying Thrift methods as much as possible to allow any Perl developer a small learning curve when using Cassandra.</p>

<h1><a href="#___top" title="click to go to top of document" name="SYNOPSYS">SYNOPSYS</a></h1>

<pre>        my ($keyspace, $column_family) = qw/simple simple/;

        my $conn = Cassandra::Simple-&gt;new(keyspace =&gt; $keyspace,);

        $conn-&gt;create_column_family( $keyspace, $column_family);

        $conn-&gt;insert($column_family, 'KeyA', { 'ColumnA' =&gt; 'AA' , 'ColumnB' =&gt; 'AB' } );

        $conn-&gt;get($column_family, 'KeyA');
        $conn-&gt;get($column_family, 'KeyA', { columns =&gt; [ qw/ColumnA/ ] });
        $conn-&gt;get($column_family, 'KeyA', { column_count =&gt; 1, column_reversed =&gt; 1 });

        $conn-&gt;batch_insert($column_family, { 'KeyB' =&gt; [ [ 'ColumnA' =&gt; 'BA' ] , [ 'ColumnB' =&gt; 'BB' ] ], 'KeyC' =&gt; [ [ 'ColumnA' =&gt; 'CA' ] , [ 'ColumnD' =&gt; 'CD' ] ] });

        $conn-&gt;multiget($column_family, [qw/KeyA KeyC/]);

        $conn-&gt;get_range($column_family, { start=&gt; 'KeyA', finish =&gt; 'KeyB', column_count =&gt; 1 });
        $conn-&gt;get_range($column_family);

        $conn-&gt;get_indexed_slices($column_family, { expression_list =&gt; [ [ 'ColumnA' =&gt; 'BA' ] ] });

        $conn-&gt;remove($column_family, [ 'KeyA' ], { columns =&gt; [ 'ColumnA' ]});
        $conn-&gt;remove($column_family, [ 'KeyA' ]);
        $conn-&gt;remove($column_family);

        $conn-&gt;get_count($column_family, 'KeyA');
        $conn-&gt;multiget_count($column_family, [ 'KeyB', 'KeyC' ]);</pre>

<h2><a href="#___top" title="click to go to top of document" name="get">get</a></h2>

<p>Usage: <code>get($column_family, $key[, opt])</code></p>

<p><code>$opt</code> is a <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>columns, column_start, column_finish, column_count, column_reversed, super_column, consistency_level_read</p>
</blockquote>

<p>Returns an HASH of the form <code>{ column =&gt; value, column =&gt; value }</code></p>

<h2><a href="#___top" title="click to go to top of document" name="multiget">multiget</a></h2>

<p>Usage: <code>multiget($column_family, $keys[, opt])</code></p>

<p><code>$keys</code> should be an <i>ARRAYREF</i> of keys to fetch.</p>

<p>All parameters in <code>$opt</code> are the same as in <code>get()</code></p>

<p>Returns an HASH of the form <code>{ key =&gt; { column =&gt; value, column =&gt; value }, key =&gt; { column =&gt; value, column =&gt; value } }</code></p>

<h2><a href="#___top" title="click to go to top of document" name="get_count">get_count</a></h2>

<p>Usage: <code>get_count($column_family, $key[, opt])</code></p>

<p><code>$opt</code> is a <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>columns, column_start, column_finish, super_column, consistency_level_read</p>
</blockquote>

<p>Returns the count as an int</p>

<h2><a href="#___top" title="click to go to top of document" name="multiget_count">multiget_count</a></h2>

<p>Usage: <code>multiget_count($column_family, $keys[, opt])</code></p>

<p><code>$keys</code> should be an <i>ARRAYREF</i> of keys.</p>

<p>All parameters in <code>$opt</code> are the same as in <code>get_count()</code></p>

<p>Returns a mapping of <code>key -&gt; count</code></p>

<h2><a href="#___top" title="click to go to top of document" name="get_range">get_range</a></h2>

<p>Usage: <code>get_range( $column_family[, opt])</code></p>

<p><code>$opt</code> is a <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>start, finish, columns, column_start, column_finish, column_reversed, column_count, row_count, super_column, consistency_level_read</p>
</blockquote>

<p>Returns an <i>HASH</i> of the form <code>{ key =&gt; { column =&gt; value, column =&gt; value }, key =&gt; { column =&gt; value, column =&gt; value } }</code></p>

<h2><a href="#___top" title="click to go to top of document" name="get_indexed_slices">get_indexed_slices</a></h2>

<p>Usage: <code>get_indexed_slices($column_family, $index_clause[, opt])</code></p>

<p><code>$index_clause</code> is an <i>HASH</i> containing the following keys:</p>

<blockquote>
<p>expression_list, start_key, row_count</p>

<p>The <i>expression_list</i> is an <i>ARRAYREF</i> of <i>ARRAYREF</i> containing <code>$column[, $operator], $value</code>. <code>$operator</code> can be '=', '&lt;', '&gt;', '&lt;=' or '&gt;='.</p>
</blockquote>

<p><code>$opt</code> is an <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>columns, column_start, column_finish, column_reversed, column_count, consistency_level_read</p>
</blockquote>

<p>Returns an <i>HASH</i> of the form <code>{ key =&gt; { column =&gt; value, column =&gt; value }, key =&gt; { column =&gt; value, column =&gt; value } }</code></p>

<h2><a href="#___top" title="click to go to top of document" name="insert">insert</a></h2>

<p>Usage: <code>insert($column_family, $key, $columns[, opt])</code></p>

<p>The <code>$columns</code> is an <i>HASHREF</i> of the form <code>{ column =&gt; value, column =&gt; value }</code></p>

<p><code>$opt</code> is an <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>timestamp, ttl, consistency_level_write</p>
</blockquote>

<h2><a href="#___top" title="click to go to top of document" name="insert_super">insert_super</a></h2>

<p>Usage: <code>insert_super($column_family, $key, $columns[, opt])</code></p>

<p>The <code>$columns</code> is an <i>HASH</i> of the form <code>{ super_column =&gt; { column =&gt; value, column =&gt; value } }</code></p>

<p><code>$opt</code> is an <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>timestamp, ttl, consistency_level_write</p>
</blockquote>

<h2><a href="#___top" title="click to go to top of document" name="batch_insert">batch_insert</a></h2>

<p>Usage: <code>batch_insert($column_family, $rows[, opt])</code></p>

<p><code>$rows</code> is an <i>HASH</i> of the form <code>{ key =&gt; { column =&gt; value , column =&gt; value }, key =&gt; { column =&gt; value , column =&gt; value } }</code></p>

<p><code>$opt</code> is an <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>timestamp, ttl, consistency_level_write</p>
</blockquote>

<h2><a href="#___top" title="click to go to top of document" name="add">add</a></h2>

<p>Usage: <code>add($column_family, $key, $column, [$value [, opt]])</code></p>

<p>Increment or decrement counter <code>$column</code> by <code>$value</code>. <code>$value</code> is 1 by default.</p>

<p><code>$opt</code> is a <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>super_column, consistency_level_write</p>
</blockquote>

<h2><a href="#___top" title="click to go to top of document" name="batch_add">batch_add</a></h2>

<p>Usage: <code>batch_add($column_family, $rows[, opt])</code></p>

<p><code>$rows</code> is an <i>HASH</i> of the form <code>{ key =&gt; { column =&gt; value , column =&gt; value }, key =&gt; { column =&gt; value , column =&gt; value } }</code></p>

<p><code>$opt</code> is an <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>consistency_level_write</p>
</blockquote>

<h2><a href="#___top" title="click to go to top of document" name="remove_counter">remove_counter</a></h2>

<p>Usage: <code>remove_counter($column_family, $key, $column [, opt])</code></p>

<p>Remove counter <code>$column</code> on <code>$key</code>.</p>

<p><code>$opt</code> is a <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>super_column, consistency_level_write</p>
</blockquote>

<h2><a href="#___top" title="click to go to top of document" name="remove">remove</a></h2>

<p>Usage: <code>remove($column_family[, $keys][, opt])</code></p>

<p><code>$keys</code> is a key or an <i>ARRAY</i> of keys to be deleted.</p>

<p>A removal whitout keys truncates the whole column_family.</p>

<p><code>$opt</code> is an <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>columns, super_column, write_consistency_level</p>
</blockquote>

<p>The timestamp used for remove is returned.</p>

<h2><a href="#___top" title="click to go to top of document" name="list_keyspace_cfs">list_keyspace_cfs</a></h2>

<p>Usage: <code>list_keyspace_cfs()</code></p>

<p>Returns an HASH of <code>{ column_family_name =&gt; column_family_type }</code> where column family type is either <code>Standard</code> or <code>Super</code></p>

<h2><a href="#___top" title="click to go to top of document" name="create_column_family">create_column_family</a></h2>

<p>Usage <code>create_column_family($keyspace, $column_family[, $cfdef])</code></p>

<p>Creates a new column family <code>$column_family</code> in keyspace <code>$keyspace</code>. <code>$cfdef</code> is an HASH containing Column Family Definition options (column_type, comparator_type, etc.).</p>

<h2><a href="#___top" title="click to go to top of document" name="create_keyspace">create_keyspace</a></h2>

<p>Usage <code>create_keyspace($keyspace [, $opt])</code></p>

<p><code>$opt</code> is an <i>HASH</i> and can have the following keys:</p>

<blockquote>
<p>strategy</p>
</blockquote>

<h2><a href="#___top" title="click to go to top of document" name="list_keyspaces">list_keyspaces</a></h2>

<p>Usage <code>list_keyspaces()</code></p>

<h2><a href="#___top" title="click to go to top of document" name="drop_keyspace">drop_keyspace</a></h2>

<p>Usage <code>drop_keyspace($keyspace [, $opt])</code></p>

<h2><a href="#___top" title="click to go to top of document" name="create_index">create_index</a></h2>

<p>Usage: <code>create_index($keyspace, $column_family, $columns, [$validation_class])</code></p>

<p>Creates an index on <code>$columns</code> of <code>$column_family</code>. <code>$columns</code> is an ARRAY of column names to be indexed. <code>$validation_class</code> only applies when <code>$column</code> doesn't yet exist, and even then it is optional (defaults to <i>BytesType</i>).</p>

<h2><a href="#___top" title="click to go to top of document" name="ring">ring</a></h2>

<p>Usage: <code>ring($keyspace)</code></p>

<p>Lists the addresses of all nodes on the cluster associated with the keyspace <code>&lt;$keyspace</code>&gt;.</p>

<h1><a href="#___top" title="click to go to top of document" name="BUGS">BUGS</a></h1>

<p>Bugs should be reported on github at <a href="https://github.com/fmgoncalves/p5-cassandra-simple">https://github.com/fmgoncalves/p5-cassandra-simple</a>.</p>

<h1><a href="#___top" title="click to go to top of document" name="TODO">TODO</a></h1>

<p><b>Thrift Type Checking and Packing/Unpacking</b></p>

<p>The defined types (or defaults) for each column family are known and should therefore be complied with. Introducing Composite Types has forcefully introduced this functionality to an extent, but there should be a refactoring to make this ubiquitous to the client.</p>

<p><b>Error Handling</b></p>

<p>Exceptions raised when calling Cassandra code should be reported in error form with appropriate description.</p>

<p><b>Unit Tests</b></p>

<blockquote>
<p>Sort of done in the examples folder <a href="https://github.com/fmgoncalves/p5-cassandra-simple/tree/master/examples">https://github.com/fmgoncalves/p5-cassandra-simple/tree/master/examples</a></p>
</blockquote>

<p><b>Tombstones</b></p>

<p>get, get_range and get_indexed_slices should probably filter out tombstones, even if it means returning less than the requested count. Ideally it would retry until it got enough results.</p>

<p><b>Methods</b></p>

<p>The following are Thrift methods left unimplemented.</p>

<p>Not all of these will be implemented, since some aren't useful to the common developer.</p>

<p>Priority will be given to live schema updating methods.</p>

<blockquote>
<p>describe_cluster_name</p>

<p>string describe_cluster_name()</p>

<p>describe_keyspace</p>

<p>KsDef describe_keyspace(string keyspace)</p>

<p>describe_partitioner</p>

<p>string describe_partitioner()</p>

<p>describe_snitch</p>

<p>string describe_snitch()</p>

<p>describe_version</p>

<p>string describe_version()</p>

<p>system_drop_column_family</p>

<p>string system_drop_column_family(ColumnFamily column_family)</p>
</blockquote>

<h1><a href="#___top" title="click to go to top of document" name="ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a></h1>

<p>Implementation loosely based on Cassandra::Lite.</p>

<blockquote>
<p><a href="http://search.cpan.org/~gslin/Cassandra-Lite-0.0.4/lib/Cassandra/Lite.pm">http://search.cpan.org/~gslin/Cassandra-Lite-0.0.4/lib/Cassandra/Lite.pm</a></p>
</blockquote>

<p>API based on Pycassa.</p>

<blockquote>
<p><a href="http://pycassa.github.com/pycassa/">http://pycassa.github.com/pycassa/</a></p>
</blockquote>

<h1><a href="#___top" title="click to go to top of document" name="AUTHOR">AUTHOR</a></h1>

<p>Filipe Gonçalves <code>&lt;the.wa.syndrome@gmail&gt;</code></p>

<h1><a href="#___top" title="click to go to top of document" name="COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</a></h1>

<p>This software is copyright (c) 2011 by Filipe Gonçalves.</p>

<p>This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</p>



<p></p> 
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/fmgoncalves">fmgoncalves</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>